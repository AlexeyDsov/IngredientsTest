<?php
$partViewer->view('header');

$formId = 'editForm'.time().rand(10000, 99999);
?>
<form id="<?=$formId?>" method="post" action="<?=$takeUrl?>">
	<?php
	$partViewer->view('Objects/SimpleObject/edit.table');
	?>
</form>
<?php
if ($this->get('isAjax') && $infoObject) {
	$dialogName = $this->get('linker')->getDialogName($infoObject);
	$title = get_class($infoObject).' id: '.$infoObject->getId();
	if ($infoObject instanceof NamedObject) {
		$title .= ", name: {$infoObject->getName()}";
	}
	?>
	<script type="text/javascript">
		$('#<?=$dialogName?>').dialog('option', {
			title: "Editing <?=$title?>",
			buttons: {
				Save: function() {$.sendPostForm($('#<?=$formId?>'), $('#<?=$dialogName?>'));},
				<?php
				if ($form->getValue('id')) {
					?>
					Cancel: function() {DialogController.spawnByUrl('<?=$infoUrl?>', '<?=$dialogName?>');}
					<?php
				} else {
				?>
					Cancel: function() {$(this).dialog('close');}
				<?php
				}
				?>
			}
		});
	</script>
	<?php
}
$partViewer->view('footer');
?>