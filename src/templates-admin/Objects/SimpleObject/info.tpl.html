<?php
$partViewer->view('header');

$partViewer->view('Objects/SimpleObject/info.table');

if ($this->get('isAjax')) {
	$dialogName = $this->get('linker')->getDialogName($infoObject);
	$title = get_class($infoObject).' id: '.$infoObject->getId();
	if ($infoObject instanceof NamedObject) {
		$title .= ", name: {$infoObject->getName()}";
	}
	?>
	<script type="text/javascript">
		var windowHeight = (window.innerHeight - 200);
		$('#<?=$dialogName?>').dialog('option', {
			title: "Info of <?=$this->escape($title)?>",
			width: 600,
			height: windowHeight,
			buttons: {
				<?php
				/**
				 * @todo убрать здесь эти извращения и передавать в js "json данные", которые будут генерить кнопки
				 * сам это сделаю, но несколько позже
				 */
				foreach ($buttonUrlList as $buttonName => $buttonOptions) {
					if ($buttonOptions['window']) {
						?>
						<?=$buttonName?>: function() {
							DialogController.spawnByUrl('<?=$buttonOptions['url']?>', '<?=$dialogName?>');
						},
						<?php
					} else {
						?>
						<?=$buttonName?>: function() {
							Application.goUrl('<?=$buttonOptions['url']?>')
						},
						<?php
					}
				}
				?>
				Close: function() {
					$('#<?=$dialogName?>').dialog('close');
				}
			}
		});
	</script>
	<?php
}
$partViewer->view('footer');
?>